---
title: 垃圾回收机制
date: 2017-02-04
comments: false
toc: true
categories: "Python基础"
tags: [GC]
---

###  引入

当我们的cpython(C语言编写的python 解释器) 执行到定义变量的语法时, 会向系统申请内存空间来存储变量, 而 内存的容量是有限的, 那么这就牵扯到一个内存空间的回收问题.  当一个变量不再被使用, 就需要把这个变量所占用的内存空间回收. 

由于变量名是访问变量值的唯一方式, 所以当一个变量值不再关联任何的变量名时, 我们就无法再访问到该变量值,  此时该变量值就是垃圾,  cpython 为我们 提供了自动的垃圾回收机制来帮我们解决垃圾回收的问题

### 垃圾回收机制

垃圾回收机制 (简称GC) 是python 解释器自带的一种机制, 是专门用来回收不可以的变量值所占用的内存空间

### 为什么要用垃圾回收机制

程序运行中需要申请大量的内存空间, 而对于一些无用的内存空间如果不及时清除, 会导致内存耗尽,程序崩溃,  电脑(服务器) 宕机等, 引发严重问题.  因此管理内存是一件重要且繁杂的事情.

### 垃圾回收机制原理

Python 的 GC 模块主要运用了"引用计数"(referrence counting) 来跟踪和回收垃圾, 在引用计数基础上, 还可以通过"标记-清除" ( mark and sweep ) 解决容器对象可能产生的循环引用问题, 并且通过"分代回收"(generation collection) 以空间换取时间的方式来进一步提高垃圾回收效率

#### 什么是引用计数

引用计数就是: 变量值被变量名关联的次数

如:  age = 23

变量值 23 被 变量名 age 关联, 此时的 引用计数为1

![](https://gitee.com/qilitang/Img/raw/master/img/20200407072426.png)

引用计数增加

age = 23  ( 此时23 的引用计数次数为1 )

m = age ( 把 age的内存地址给了 m, 此时,. m,age 都关联23 , 所以变量值23的引用计数为2)

![](https://gitee.com/qilitang/Img/raw/master/img/20200407072655.png)

引用计数的减少:

age = 18 ( 名字 age 先与23 解除关联, 再与18 简历关联, 此时 变量值得引用计数为1)

![](https://gitee.com/qilitang/Img/raw/master/img/20200407073008.png)

